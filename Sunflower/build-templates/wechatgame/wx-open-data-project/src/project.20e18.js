window.__require=function e(t,r,a){function n(o,c){if(!r[o]){if(!t[o]){var s=o.split("/");if(s=s[s.length-1],!t[s]){var d="function"==typeof __require&&__require;if(!c&&d)return d(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+o+"'")}}var l=r[o]={exports:{}};t[o][0].call(l.exports,function(e){return n(t[o][1][e]||e)},l,l.exports,e,t,r,a)}return r[o].exports}for(var i="function"==typeof __require&&__require,o=0;o<a.length;o++)n(a[o]);return n}({Rank:[function(e,t,r){"use strict";cc._RF.push(t,"e53e6YiUd9FJLf8yIQu1n47","Rank");var a=cc.Enum({TOP3:0,OTHERS:1,SELF:2});cc.Class({extends:cc.Component,properties:{content:cc.Node,selfNode:cc.Node,prefab:cc.Prefab,itemBgs:{default:[],type:cc.SpriteFrame},itemNumberTop3:{default:[],type:cc.SpriteFrame},_dataArray:[]},start:function(){var e=this;if(cc.sys.platform==cc.sys.WECHAT_GAME)wx.onMessage(function(t){if(console.log("onMessage..",t),"getFriendRank"==t.message){var r=t.openId;console.log("selfOpenId:",r),e.content.children.forEach(function(e){e.destroy()}),e._dataArray=[],wx.getFriendCloudStorage({keyList:["score"],success:function(t){if(console.log("friend success",t),t.data.length>0){for(var n=0;n<t.data.length;n++){var i=t.data[n];if(i){var o=i.openid,c=i.nickname,s=i.avatarUrl,d=i.KVDataList[0].value;e._dataArray.push(e._itemObj(0,o,s,c,d))}}e._dataArray.sort(function(e,t){return parseInt(e.score)<parseInt(t.score)?1:parseInt(e.score)>parseInt(t.score)?-1:0}),console.log("\u6392\u5e8f\u540e\u7684\u6570\u636e:",e._dataArray);for(var l=e._dataArray.length>10?10:e._dataArray.length,f=0;f<l;f++){var g=e.createPrefab(),m=e._dataArray[f];m.id=f+1,e._setItemNode(g,m.id<4?a.TOP3:a.OTHERS,m)}e.selfNode.active=!1;for(var p=0;p<e._dataArray.length;p++){var u=e._dataArray[p];if(u.id=p+1,r==u.openId){console.log("selfData:",u),e._setItemNode(e.createPrefab(),a.SELF,u),e.selfNode.active=!0;break}}}},fail:function(e){console.error(e)}})}});else{console.log("\u975e\u5fae\u4fe1\u73af\u5883...");for(var t=1;t<11;t++){var r=this.createPrefab(),n=new this._itemObj(t,"","http://192.168.1.134:12888/img/head.png","Javen",100+t);this._setItemNode(r,t<4?a.TOP3:a.OTHERS,n)}var i=new this._itemObj(100,"","http://192.168.1.134:12888/img/head.png","Javen001",100);this._setItemNode(this.createPrefab(),a.SELF,i)}},_setItemNode:function(e,t,r){e.getChildByName("score").getComponent(cc.Label).string=r.score;var n=e.getChildByName("head").getChildByName("head");this.loadImgByUrl(n,r.avatarUrl),e.getComponent(cc.Sprite).spriteFrame=this.itemBgs[t],e.getChildByName("bannerId").getChildByName("name").getComponent(cc.Label).string=this.stringTodo(r.nickName,8);var i=e.getChildByName("no"),o=e.getChildByName("number"),c=e.getChildByName("numImg");i.active=!1,o.active=!1,c.active=!1,t==a.TOP3?(c.getComponent(cc.Sprite).spriteFrame=this.itemNumberTop3[r.id-1],c.active=!0):t==a.OTHERS?(o.getComponent(cc.Label).string=r.id,o.active=!0):t==a.SELF&&(r.id<=0?i.active=!0:(o.getComponent(cc.Label).string=r.id,o.active=!0)),t==a.SELF&&(e.parent=this.selfNode)},_itemObj:function(e,t,r,a,n){return{id:e,openId:t,nickName:a,score:n,avatarUrl:r}},createPrefab:function(){var e=cc.instantiate(this.prefab);return e.parent=this.content,e},loadImgByUrl:function(e,t,r){var a=this;r||(r="png"),cc.loader.load({url:t,type:r},function(t,r){t||a.setImg(e,new cc.SpriteFrame(r))})},setImg:function(e,t){e.getComponent(cc.Sprite).spriteFrame=t},stringTodo:function(e,t){var r=/[\u4e00-\u9fa5]/g,a=e.substring(0,t),n=~~(a.match(r)&&a.match(r).length),i=2*a.length-n;return e.substr(0,i)+(i<e.length?"...":"")}}),cc._RF.pop()},{}]},{},["Rank"]);